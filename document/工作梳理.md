# 工作梳理

> ctrl + 向上滚轮可以放大网页

## 1. 获取数据

![image-20220718161530313](https://s1.328888.xyz/2022/07/18/lNVNr.png)

### 1.1 获取所有股票的代码

#### get_tickers_us_nasdaq

> pyfinviz

#### get_tickers_us_nyse

> pyfinviz

#### get_tickers_ch

> tushare

1. 以上代码获得了美股和中股的所有股票代码
2. 获得了分类

### 1.2 获取所有股票的历史价格

#### get_single_ticker_ch.ipynb

> baostock, tushare(数据有问题)

1. 获取了全部的中国股票及其历史数据
2. 实现了动态更新（需要服务器）

#### get_single_ticker_us.ipynb

> yfinance

1. 获取了全部的美国股票及其历史数据
2. 实现了动态更新（需要服务器）

### 1.3 获取各种指数

#### get_index_ch.py

> baostock api

1. 动态获取上证50成分股
2. 动态获得沪深300成分股
3. 动态获得中证500成分股

#### get_index_us.py

> beautifulsoap

1. 动态获取nasdaq100
2. 动态获取sp500
3. 动态获取dowjones50

### 1.4 读取数据和写入数据

> sqlite3, pandas

#### database_write_read.ipynb

#### database_store.ipynb

### 结果

[![lNsaK.png](https://s1.328888.xyz/2022/07/18/lNsaK.png)](https://imgloc.com/image/lNsaK)

![lNUXJ.png](https://s1.328888.xyz/2022/07/18/lNUXJ.png)

![lN8PE.png](https://s1.328888.xyz/2022/07/18/lN8PE.png)

![lNJuw.png](https://s1.328888.xyz/2022/07/18/lNJuw.png)

## 2. 中长期投资思路梳理

我们对于中长期的选股的思路分为以下两个方面：

1. “自上而下”：大盘找低点
2. “自下而上”：个股找高点

对于大盘来说，我们通常买在低点的位置，但是对于个股我们一定不能买在低点。原因在于对于股票和购物是不一样的思维。如果我们是日常买东西，我们可以买在低点，打折的时候，但是对于股票，“贪便宜”的想法会造成很大的损失。一个股票的价格越低，就说明这个股票越不值钱。借用一句形象的比喻：永远不要用手接一个下落的刀子。所以我们要解决两个问题：1.如何判断大盘，2.如何判断个股。

### 2.1 如何判断大盘的低点、高点、拐点

对于大盘，散户常常有一个误解，即用各种指数来判断大盘的整体走向，但是这其中有很多的问题。因为权值的不同，导致了大户可以通过“换股”的方法来让大盘“看起来在整体上升”。我们用美股的sp500数据为例：

首先是SP500的数据（周线图）：

![llFeI.png](https://s1.328888.xyz/2022/07/18/llFeI.png)

我们发现了从2020年3月20日到2022年1月3日SP500的指数一直在提高，如果通过大盘我们会觉得2022年1月3日牛市才结束。但是我们看另一个数据：

高于MA200的股票占比（周线图）：

![llDoX.png](https://s1.328888.xyz/2022/07/18/llDoX.png)

我们发现从2021年2月8日占比就一直下降，到了2022年的1月3日只有不到一半的股票还高于MA200

#### 30和70

所以我们决定用下面的占比来判断牛市和熊市，有意思的是这个数据和RSI非常非常的相似，30和70是一个很重要的线，如下面高于MA200的股票占比（月线图）所示：

![ll0tK.png](https://s1.328888.xyz/2022/07/18/ll0tK.png)

#### 10和90

更进一步我们可以发现，10-15的范围是低点（我在写这篇文章的时候2022/7/18 17:42，判断美股的市场可能还有1-3个月的下跌，但是即将以来反弹，除非有黑天鹅的事件发生)，而高点用80-90非常合适，历史上的高点都触碰到了90的高位，但是90也是一个信号，意味着过度繁荣。也可能成为由盛转衰的开始。

![llTB7.png](https://s1.328888.xyz/2022/07/18/llTB7.png)

#### 总结

这个百分比可以说和RSI完全一致，关键的点位10，30，50，70，90. 

#### 原因分析

通过观察SP500的前50名weight（当前时间：2022/7/18 18:01）：

```python
import pandas as pd
from get_index_us import get_sp500
sp500 = get_sp500()
sp500.head(50).to_csv('sp500-top50.csv')
```

**result 'sp500-top50.csv'**

|      | symbol | weight   |
| ---- | ------ | -------- |
| 0    | AAPL   | 7.145571 |
| 1    | MSFT   | 5.948039 |
| 2    | AMZN   | 3.029958 |
| 3    | GOOGL  | 2.078025 |
| 4    | GOOG   | 1.92386  |
| 5    | TSLA   | 1.877899 |
| 6    | BRK.B  | 1.553953 |
| 7    | UNH    | 1.476786 |
| 8    | JNJ    | 1.446995 |
| 9    | NVDA   | 1.204824 |
| 10   | META   | 1.134629 |
| 11   | XOM    | 1.096256 |
| 12   | PG     | 1.090979 |
| 13   | V      | 1.060702 |
| 14   | JPM    | 0.99286  |
| 15   | HD     | 0.936327 |
| 16   | PFE    | 0.902539 |
| 17   | MA     | 0.875109 |
| 18   | CVX    | 0.836037 |
| 19   | ABBV   | 0.832118 |
| 20   | LLY    | 0.806924 |
| 21   | KO     | 0.759353 |
| 22   | MRK    | 0.7431   |
| 23   | PEP    | 0.739992 |
| 24   | COST   | 0.710227 |
| 25   | BAC    | 0.668631 |
| 26   | VZ     | 0.663704 |
| 27   | TMO    | 0.644077 |
| 28   | AVGO   | 0.619364 |
| 29   | MCD    | 0.584729 |
| 30   | ABT    | 0.579354 |
| 31   | WMT    | 0.561688 |
| 32   | CMCSA  | 0.553853 |
| 33   | ADBE   | 0.5516   |
| 34   | CSCO   | 0.550413 |
| 35   | ACN    | 0.532672 |
| 36   | DIS    | 0.523621 |
| 37   | DHR    | 0.502449 |
| 38   | CRM    | 0.500807 |
| 39   | QCOM   | 0.497457 |
| 40   | BMY    | 0.493215 |
| 41   | NEE    | 0.492724 |
| 42   | INTC   | 0.482649 |
| 43   | WFC    | 0.459617 |
| 44   | T      | 0.455562 |
| 45   | TXN    | 0.455103 |
| 46   | PM     | 0.434836 |
| 47   | LIN    | 0.423781 |
| 48   | RTX    | 0.419768 |
| 49   | NKE    | 0.411284 |

**我们通过上图发现，前面的1-5名公司有着非常高的权重，这也使得big money可以一边卖出其它公司的股票转而买入权重高的股票，这样大盘会处于一直上升，但是实际上经济已经开始下行。**



### 2.2 如何判断股票的buy_zone, hold_zone, sell_zone, no_operation_zone

根据指标我制作了一个初级的Score判断系统，这个系统的目标在于实现找到合适的买入点和卖出点。目前我仅仅实现了买入点的判断，下面是我对于买入点的一些判断例子（不论结果好坏都放到这里），卖出点我用MA50和MA200或者MA10下穿MA20这些简易的价格指标做判断。而对于`hold_zone(持有区)`和`no_operation_zone(比如下降中不能抄底，或者上升中不能购买，和持有区有一定的区别)`

我的判断原则是：

1. 买入高于MA200，MA150，并且MA50高于MA200的股票
2. 买入趋势上涨的股票
3. 买入创新高或者接近4年新高的股票
4. 买入特定形态的股票（双底，杯形，VCP）

下面我们一起看一些例子，我的模型的创建开始是根据比特币进行测试，后经一些参数的调整应用到了中国股票市场，难免会出线一些水土不服的情况。但是不论如何让我们一起看看实际效果（也是本人的第一次系统测试，由于之前在忙着中期答辩，一直没有时间）闲言少叙，我们开始：

#### 1. 中国股票

首先我们就从最可能出错的中国股票开始，我随机选取两个中国常见的股票：

![ljnoR.png](https://s1.328888.xyz/2022/07/18/ljnoR.png)

那么这里我们随机选取的是**恒力石化**和**中国石油**，我们依次来研究，首先运行我们的Score系统，获得恒力石化的历史Score.csv文件（方便后续操作）

![lub40.png](https://s1.328888.xyz/2022/07/18/lub40.png)

##### 1.1 恒力石化

由于这个时间从2001年开始，年代有些太长了，我选取近5年的部分来作为参考

###### 2017/05/08-2018/01/16

| ts_code   | trade_date | total_score  |
| --------- | ---------- | ------------ |
| 600346.SH | 20170508   | -19.8        |
| 600346.SH | 20170509   | -14.3        |
| 600346.SH | 20170510   | -23.8        |
| 600346.SH | 20170511   | -18.3        |
| 600346.SH | 20170512   | -18.3        |
| 600346.SH | 20170515   | -16.3        |
| 600346.SH | 20170516   | -14.8        |
| 600346.SH | 20170517   | -14.8        |
| 600346.SH | 20170518   | -6.3         |
| 600346.SH | 20170519   | -13.3        |
| 600346.SH | 20170522   | -11.3        |
| 600346.SH | 20170523   | -21.8        |
| 600346.SH | 20170524   | -17.8        |
| 600346.SH | 20170525   | -14.3        |
| 600346.SH | 20170526   | -11.3        |
| 600346.SH | 20170531   | -4.8         |
| 600346.SH | 20170601   | -4.8         |
| 600346.SH | 20170602   | -4.8         |
| 600346.SH | 20170605   | ==2.345252== |
| 600346.SH | 20170606   | ==5.132954== |
| 600346.SH | 20170607   | -4.8         |
| 600346.SH | 20170608   | ==12.39784== |
| 600346.SH | 20170609   | 0.74549      |
| 600346.SH | 20170612   | 2.799165     |
| 600346.SH | 20170613   | 4.90216      |
| 600346.SH | 20170614   | 8.22923      |
| 600346.SH | 20170615   | 12.91613     |
| 600346.SH | 20170616   | 6.2          |
| 600346.SH | 20170619   | 6.2          |
| 600346.SH | 20170620   | 8.2          |
| 600346.SH | 20170621   | 2.7          |
| 600346.SH | 20170622   | ==7.810389== |
| 600346.SH | 20170623   | ==11.1859==  |
| 600346.SH | 20170626   | ==12.39421== |
| 600346.SH | 20170627   | ==16.52494== |
| 600346.SH | 20170628   | 4.7          |
| 600346.SH | 20170629   | 8.2          |
| 600346.SH | 20170630   | 11.02944     |
| 600346.SH | 20170703   | -0.3         |
| 600346.SH | 20170704   | 14.25393     |
| 600346.SH | 20170705   | -2.8         |
| 600346.SH | 20170714   | 2.7          |
| 600346.SH | 20170717   | 5.7          |
| 600346.SH | 20170718   | 17.58265     |
| 600346.SH | 20170719   | 2.7          |
| 600346.SH | 20170720   | 11.2         |
| 600346.SH | 20170721   | 2.7          |
| 600346.SH | 20170724   | 4.2          |
| 600346.SH | 20170725   | 12.50218     |
| 600346.SH | 20170726   | 4.2          |
| 600346.SH | 20170727   | 12.7011      |
| 600346.SH | 20170728   | 0.2          |
| 600346.SH | 20170731   | -2.3         |
| 600346.SH | 20170801   | 1.2          |
| 600346.SH | 20170802   | 3.7          |
| 600346.SH | 20170803   | -2.3         |
| 600346.SH | 20170804   | 1.2          |
| 600346.SH | 20170807   | 1.2          |
| 600346.SH | 20170808   | -2.3         |
| 600346.SH | 20170809   | 3.2          |
| 600346.SH | 20170810   | 0.2          |
| 600346.SH | 20180111   | 6.2          |
| 600346.SH | 20180112   | 3.5          |
| 600346.SH | 20180115   | 2.7          |
| 600346.SH | 20180116   | 3.5          |

通过这个评分系统我们发现了两个high-score区域（已用黄色标记，下面我们来开始复盘）

![luQHk.png](https://s1.328888.xyz/2022/07/18/luQHk.png)

*我们60天的回报率大概是25%-30%，这个结果比我意料的还要好一点，自己也不太了解中国股票。总之这个结果初步看比较满意，所以我想再尝试一个时间段。

###### 2018/01/19-2019/03/26

| ts_code   | trade_date | total_score  |
| --------- | ---------- | ------------ |
| 600346.SH | 20181019   | -11.6        |
| 600346.SH | 20181022   | -10.8        |
| 600346.SH | 20181023   | -7.3         |
| 600346.SH | 20181024   | -10.1        |
| 600346.SH | 20181025   | -10.8        |
| 600346.SH | 20181026   | -8.8         |
| 600346.SH | 20181029   | -10.8        |
| 600346.SH | 20181030   | -9.3         |
| 600346.SH | 20181031   | -4.3         |
| 600346.SH | 20181101   | -6.3         |
| 600346.SH | 20181102   | -12          |
| 600346.SH | 20181105   | -6.5         |
| 600346.SH | 20181106   | -3.5         |
| 600346.SH | 20181107   | -3.5         |
| 600346.SH | 20181108   | -10.8        |
| 600346.SH | 20181109   | -3.5         |
| 600346.SH | 20181112   | -3.5         |
| 600346.SH | 20181113   | -3.5         |
| 600346.SH | 20181114   | -6.5         |
| 600346.SH | 20181115   | -5.5         |
| 600346.SH | 20181116   | -5.5         |
| 600346.SH | 20181119   | -3.5         |
| 600346.SH | 20181120   | -12.8        |
| 600346.SH | 20181121   | -11.6        |
| 600346.SH | 20181122   | -11.6        |
| 600346.SH | 20181123   | -14.4        |
| 600346.SH | 20181126   | -14.4        |
| 600346.SH | 20181127   | -14.4        |
| 600346.SH | 20181128   | -13.6        |
| 600346.SH | 20181129   | -8.1         |
| 600346.SH | 20181130   | -5.1         |
| 600346.SH | 20181203   | -7.3         |
| 600346.SH | 20181204   | -7.9         |
| 600346.SH | 20181205   | -15.7        |
| 600346.SH | 20181206   | -10.7        |
| 600346.SH | 20181207   | -13.7        |
| 600346.SH | 20181210   | -8.7         |
| 600346.SH | 20181211   | -8.7         |
| 600346.SH | 20181212   | -14.4        |
| 600346.SH | 20181213   | -12.9        |
| 600346.SH | 20181214   | -9.9         |
| 600346.SH | 20181217   | -17.2        |
| 600346.SH | 20181218   | -15.2        |
| 600346.SH | 20181219   | -17.2        |
| 600346.SH | 20181220   | -17.2        |
| 600346.SH | 20181221   | -13.7        |
| 600346.SH | 20181224   | -10.7        |
| 600346.SH | 20181225   | -12.7        |
| 600346.SH | 20181226   | -15.7        |
| 600346.SH | 20181227   | -19.2        |
| 600346.SH | 20181228   | -13.7        |
| 600346.SH | 20190102   | -17.7        |
| 600346.SH | 20190103   | -10.7        |
| 600346.SH | 20190104   | -17.2        |
| 600346.SH | 20190107   | -13.7        |
| 600346.SH | 20190108   | -12.7        |
| 600346.SH | 20190109   | -12.7        |
| 600346.SH | 20190110   | -10.7        |
| 600346.SH | 20190111   | -13.7        |
| 600346.SH | 20190114   | -14.2        |
| 600346.SH | 20190115   | -10.7        |
| 600346.SH | 20190116   | -10.7        |
| 600346.SH | 20190117   | -18.6        |
| 600346.SH | 20190118   | -11.3        |
| 600346.SH | 20190121   | -16.3        |
| 600346.SH | 20190122   | -13.3        |
| 600346.SH | 20190123   | -11.3        |
| 600346.SH | 20190124   | -13.3        |
| 600346.SH | 20190125   | -11.3        |
| 600346.SH | 20190128   | -13.3        |
| 600346.SH | 20190129   | -14.8        |
| 600346.SH | 20190130   | -12.1        |
| 600346.SH | 20190131   | -18.6        |
| 600346.SH | 20190201   | -17.8        |
| 600346.SH | 20190211   | -11.3        |
| 600346.SH | 20190212   | -12.3        |
| 600346.SH | 20190213   | -3.8         |
| 600346.SH | 20190214   | -11.5        |
| 600346.SH | 20190215   | -9.5         |
| 600346.SH | 20190218   | -3           |
| 600346.SH | 20190219   | -3           |
| 600346.SH | 20190220   | -5           |
| 600346.SH | 20190221   | -3           |
| 600346.SH | 20190222   | -9.5         |
| 600346.SH | 20190225   | -0.7         |
| 600346.SH | 20190226   | ==8.8==      |
| 600346.SH | 20190227   | ==7.8==      |
| 600346.SH | 20190228   | ==19.45357== |
| 600346.SH | 20190301   | ==15.81146== |
| 600346.SH | 20190304   | 10.8         |
| 600346.SH | 20190305   | 1.3          |
| 600346.SH | 20190306   | 2.8          |
| 600346.SH | 20190307   | 0.7          |
| 600346.SH | 20190308   | -7.1         |
| 600346.SH | 20190311   | 6.7          |
| 600346.SH | 20190312   | 5.2          |
| 600346.SH | 20190313   | 7.2          |
| 600346.SH | 20190314   | 8.2          |
| 600346.SH | 20190315   | -0.5         |
| 600346.SH | 20190318   | -4.7         |
| 600346.SH | 20190319   | -1.2         |
| 600346.SH | 20190320   | -1.2         |
| 600346.SH | 20190321   | -4.7         |
| 600346.SH | 20190322   | -3.2         |
| 600346.SH | 20190325   | -7.2         |
| 600346.SH | 20190326   | -3.2         |

这个区域可以说是我认为最最最完美的一个区域：分数从负数转正，出现high score的点，总是这可以说是理想型了，下面看看回测结果：

![lunAn.png](https://s1.328888.xyz/2022/07/18/lunAn.png)

40天时间20%-30%回报率，比之前的节约了更多的时间，较为满意。

那么对于恒力石化的部分测试到此结束，下面开始中国石油的一个测试

##### 1.2 中国石油

首先我们先看得分表

###### 2020/12/18-2021/4/15

| ts_code     | trade_date | total_score  |
| ----------- | ---------- | ------------ |
| 601857.SH   | 20201218   | -18.3        |
| 601857.SH   | 20201221   | -9.8         |
| 601857.SH   | 20201222   | -25.8        |
| 601857.SH   | 20201223   | -17.3        |
| 601857.SH   | 20201224   | -17.3        |
| 601857.SH   | 20201225   | -19.3        |
| 601857.SH   | 20201228   | -23.8        |
| 601857.SH   | 20201229   | -20.3        |
| 601857.SH   | 20201230   | -17.3        |
| 601857.SH   | 20201231   | -19.3        |
| 601857.SH   | 20210104   | -23.8        |
| 601857.SH   | 20210105   | -20.3        |
| 601857.SH   | 20210106   | -16.3        |
| 601857.SH   | 20210107   | -12.8        |
| 601857.SH   | 20210108   | -16.3        |
| 601857.SH   | 20210111   | -18.3        |
| 601857.SH   | 20210112   | -13.3        |
| 601857.SH   | 20210113   | -5.3         |
| 601857.SH   | 20210114   | -9.8         |
| 601857.SH   | 20210115   | -18.3        |
| 601857.SH   | 20210118   | -9.8         |
| 601857.SH   | 20210119   | -12.8        |
| 601857.SH   | 20210120   | -14.8        |
| 601857.SH   | 20210121   | -9.8         |
| 601857.SH   | 20210122   | -25.8        |
| 601857.SH   | 20210125   | -23.8        |
| 601857.SH   | 20210126   | -22.3        |
| 601857.SH   | 20210127   | -17.3        |
| 601857.SH   | 20210128   | -17.3        |
| 601857.SH   | 20210129   | -23.8        |
| 601857.SH   | 20210201   | -17.3        |
| 601857.SH   | 20210202   | -17.3        |
| 601857.SH   | 20210203   | -19.3        |
| 601857.SH   | 20210204   | -22.3        |
| 601857.SH   | 20210205   | -17.3        |
| 601857.SH   | 20210208   | -19.3        |
| 601857.SH   | 20210209   | -25.8        |
| 601857.SH== | 20210210   | -18.3        |
| 601857.SH   | 20210218   | -5.3         |
| 601857.SH   | 20210219   | -3.8         |
| 601857.SH   | 20210222   | -5.3         |
| 601857.SH   | 20210223   | -5.3         |
| 601857.SH   | 20210224   | -5.3         |
| 601857.SH   | 20210225   | -1.8         |
| 601857.SH   | 20210226   | 0.2          |
| 601857.SH   | 20210301   | -3.8         |
| 601857.SH   | 20210302   | -13.3        |
| 601857.SH   | 20210303   | 0.634098     |
| 601857.SH   | 20210304   | 0.2          |
| 601857.SH   | 20210305   | -5.3         |
| 601857.SH   | 20210308   | -3.8         |
| 601857.SH   | 20210309   | -1.8         |
| 601857.SH   | 20210310   | 0.404253     |
| 601857.SH   | 20210311   | 4.782877     |
| 601857.SH   | 20210312   | 6.733068     |
| 601857.SH   | 20210315   | -5.3         |
| 601857.SH   | 20210316   | ==6.053978== |
| 601857.SH   | 20210317   | ==8.079254== |
| 601857.SH   | 20210318   | ==10.27464== |
| 601857.SH   | 20210319   | 0.2          |
| 601857.SH   | 20210322   | 6.014631     |
| 601857.SH   | 20210323   | 9.867781     |
| 601857.SH   | 20210324   | -14.3        |
| 601857.SH   | 20210325   | -14.3        |
| 601857.SH   | 20210326   | -12.3        |
| 601857.SH   | 20210329   | ==10.48403== |
| 601857.SH   | 20210330   | ==14.71325== |
| 601857.SH   | 20210331   | ==12.27981== |
| 601857.SH   | 20210401   | -14.3        |
| 601857.SH   | 20210402   | -14.3        |
| 601857.SH   | 20210406   | -14.3        |
| 601857.SH   | 20210407   | -15.8        |
| 601857.SH   | 20210408   | -12.3        |
| 601857.SH   | 20210409   | -12.3        |
| 601857.SH   | 20210412   | -10.3        |
| 601857.SH   | 20210413   | -16.8        |
| 601857.SH   | 20210414   | -10.3        |
| 601857.SH   | 20210415   | -10.3        |

这个表的情况就不那么简单了，因为它短时间出现了两个buy zone，当然这些情况是无法预知的，但是我们买入股票的时候都是小部分资金试探，如果出现盈利加仓，那么我对于第一个位置投入应该是总资金的5%，第二个位置根据第一个位置的结果判断，下面我们进行回测

![l0asm.png](https://s1.328888.xyz/2022/07/18/l0asm.png)

回测的结果跟我想象的基本吻合，对于第一个点，如果设置5%止损，可能就会被平仓，对于第二个区域比较合适进场，首先不会被止损，而且资金保持的时间较短，但是总体的结果依然很差，90天15%-20%的利润，我觉得这是一个比较失败的例子了。但是公平起见我还是看一下中石油整体的一个价格波动：

![l0oLw.png](https://s1.328888.xyz/2022/07/18/l0oLw.png)

嗯……看了周线图结果，怎么说呢，这个绝对不是我想投资的股票，因为它的走势太弱了，MA200线整体下滑，在这种股票中交易是我最不想做的事，后面的测试就不进行了，因为这个股票走势实在过于弱，整体下行。

#### 2. 美国股票

美国股票我们同理进行随机抽取，我们从nasdaq100中随机选出2个股票进行测试：

![l0yC5.png](https://s1.328888.xyz/2022/07/18/l0yC5.png)

抽到了两个比较喜欢的股票：英伟达和特斯拉，下面我们立马开始对英伟达进行测试

##### 2.1 英伟达 Nivida

我们先收集近十年的数据：

![l0qKR.png](https://s1.328888.xyz/2022/07/18/l0qKR.png)

下面开始分析：

###### 2019/5/29-2019/9/4

| date       | total_score  |
| ---------- | ------------ |
| 2019/5/28  | -25.8        |
| 2019/5/29  | -24.3        |
| 2019/5/30  | -24.3        |
| 2019/5/31  | -25.8        |
| 2019/6/3   | -25.8        |
| 2019/6/4   | -25.8        |
| 2019/6/5   | -25.8        |
| 2019/6/6   | -23.8        |
| 2019/6/7   | -22.3        |
| 2019/6/10  | -20.3        |
| 2019/6/11  | -20.3        |
| 2019/6/12  | -23.8        |
| 2019/6/13  | -19.3        |
| 2019/6/14  | -20.3        |
| 2019/6/17  | -20.3        |
| 2019/6/18  | -21.8        |
| 2019/6/19  | -15.3        |
| 2019/6/20  | -19.8        |
| 2019/6/21  | -25.8        |
| 2019/6/24  | -16.3        |
| 2019/6/25  | -24.3        |
| 2019/6/26  | -16.8        |
| 2019/6/27  | -0.8         |
| 2019/6/28  | -3.8         |
| 2019/7/1   | -9.3         |
| 2019/7/2   | -9.3         |
| 2019/7/3   | -3.8         |
| 2019/7/5   | -0.8         |
| 2019/7/8   | -5.8         |
| 2019/7/9   | -12.3        |
| 2019/7/10  | -5.8         |
| 2019/7/11  | -9.3         |
| 2019/7/12  | -0.8         |
| 2019/7/15  | -2.8         |
| 2019/7/16  | -3.8         |
| 2019/7/17  | -7.3         |
| 2019/7/18  | -5.8         |
| 2019/7/19  | -7.3         |
| 2019/7/22  | 8.654328     |
| 2019/7/23  | 3.090821     |
| 2019/7/24  | 3.872236     |
| 2019/7/25  | 1.716475     |
| 2019/7/26  | ==12.86207== |
| 2019/7/29  | ==10.3182==  |
| 2019/7/30  | 7.82187      |
| 2019/7/31  | 4.74087      |
| 2019/8/1   | -9.3         |
| 2019/8/2   | -10.8        |
| 2019/8/5   | -25.8        |
| 2019/8/6   | -24.3        |
| 2019/8/7   | -21.8        |
| 2019/8/8   | -14.3        |
| 2019/8/9   | -21.8        |
| 2019/8/12  | -20.3        |
| 2019/8/13  | -21.8        |
| 2019/8/14  | -25.8        |
| 2019/8/15  | -23.8        |
| 2019/8/16  | -16.3        |
| 2019/8/19  | 0.7          |
| 2019/8/20  | 2.7          |
| 2019/8/21  | 6.2          |
| 2019/8/22  | 13.79192     |
| 2019/8/23  | -4.3         |
| 2019/8/26  | 16.50167     |
| 2019/8/27  | -3.83424     |
| 2019/8/28  | 0.421444     |
| 2019/8/29  | 8.918454     |
| 2019/8/30  | ==12.04998== |
| 2019/9/3   | ==18.86415== |
| 2019/9/4   | ==17.04335== |
| 2019/9/5   | 2.7          |
| 2019/9/6   | 13.91759     |
| 2019/9/9   | 8.2          |
| 2019/9/10  | 5.981346     |
| 2019/9/11  | ==11.1099==  |
| 2019/9/12  | ==9.92645==  |
| 2019/9/13  | ==18.04052== |
| 2019/9/16  | ==18.32363== |
| 2019/9/17  | ==20.51552== |
| 2019/9/18  | 14.59235     |
| 2019/9/19  | 13.34964     |
| 2019/9/20  | 8.480825     |
| 2019/9/23  | 13.03701     |
| 2019/9/24  | 9.246804     |
| 2019/9/25  | 9.467746     |
| 2019/9/26  | 19.90112     |
| 2019/9/27  | 7.935482     |
| 2019/9/30  | 19.13533     |
| 2019/10/1  | 9.27071      |
| 2019/10/2  | 18.18258     |
| 2019/10/3  | 5.7          |
| 2019/10/4  | 18.9266      |
| 2019/10/7  | 11.2         |
| 2019/10/8  | 7.7          |
| 2019/10/9  | 18.40269     |
| 2019/10/10 | 12.43489     |
| 2019/10/11 | 11.2         |
| 2019/10/14 | 23.79276     |
| 2019/10/15 | 2.7          |
| 2019/10/16 | 6.2          |
| 2019/10/17 | 12.092       |
| 2019/10/18 | 12.40385     |
| 2019/10/21 | 12.60297     |
| 2019/10/22 | 8.81503      |
| 2019/10/23 | 12.10457     |
| 2019/10/24 | 19.83937     |
| 2019/10/25 | 2.7          |
| 2019/10/28 | 11.25284     |
| 2019/10/29 | 13.45175     |
| 2019/10/30 | 15.01367     |

对于这组数据我觉得我可能会在2019/7/26和2019/7/29进行试仓，在2019/8/29-2019/9/4进行加仓（如果前面打损那么重新建仓，下面我们看看实际的情况：

![l64dX.png](https://s1.328888.xyz/2022/07/18/l64dX.png)

如上图所示，我们的回报率大概是200天70%到100%，这可能就是一年什么都不干资产能翻倍的现实情况吧，简单说说利润情况：如果是5%止损两次建仓都会被打损，如果是10%那么第一次会被打损。怎么说呢看到美股的数据，score的评分系统会给出几乎是中股两倍的分数有些唏嘘，美国的强势企业的能量真的十分强大。

但是我发现最近的NVDA数据十分弱（没错它的分数低起来也很低）

| date      | total_score |
| --------- | ----------- |
| 2022/2/28 | 1.496004    |
| 2022/3/1  | 2.651234    |
| 2022/3/2  | 2.988431    |
| 2022/3/3  | 3.440889    |
| 2022/3/4  | -12.4       |
| 2022/3/7  | -12.4       |
| 2022/3/8  | -10.9       |
| 2022/3/9  | -12.4       |
| 2022/3/10 | -10.9       |
| 2022/3/11 | -14.4       |
| 2022/3/14 | -14.4       |
| 2022/3/15 | -14.4       |
| 2022/3/16 | -6.4        |
| 2022/3/17 | 7.135563    |
| 2022/3/18 | 6.9         |
| 2022/3/21 | 9.2         |
| 2022/3/22 | 8.4         |
| 2022/3/23 | 12.51025    |
| 2022/3/24 | 2.2         |
| 2022/3/25 | 6.2         |
| 2022/3/28 | 9.40475     |
| 2022/3/29 | 12.57206    |
| 2022/3/30 | 11.24969    |
| 2022/3/31 | 10.16883    |
| 2022/4/1  | 13.30987    |
| 2022/4/4  | 12.40525    |
| 2022/4/5  | 13.7366     |
| 2022/4/6  | -6.4        |
| 2022/4/7  | -12.9       |
| 2022/4/8  | -14.4       |
| 2022/4/11 | -14.4       |
| 2022/4/12 | -14.4       |
| 2022/4/13 | -14.4       |
| 2022/4/14 | -14.4       |
| 2022/4/18 | -14.4       |
| 2022/4/19 | -14.4       |
| 2022/4/20 | -14.4       |
| 2022/4/21 | -14.4       |
| 2022/4/22 | -14.4       |
| 2022/4/25 | -14.4       |
| 2022/4/26 | -14.4       |
| 2022/4/27 | -12.9       |
| 2022/4/28 | -14.4       |
| 2022/4/29 | -14.4       |
| 2022/5/2  | -14.4       |
| 2022/5/3  | -12.9       |
| 2022/5/4  | -14.4       |
| 2022/5/5  | -14.4       |
| 2022/5/6  | -10.9       |
| 2022/5/9  | -14.4       |
| 2022/5/10 | -12.9       |
| 2022/5/11 | -14.4       |
| 2022/5/12 | -10.9       |
| 2022/5/13 | -14.4       |
| 2022/5/16 | -14.4       |
| 2022/5/17 | -12.9       |
| 2022/5/18 | -14.4       |
| 2022/5/19 | -16.5       |
| 2022/5/20 | -18         |
| 2022/5/23 | -18         |
| 2022/5/24 | -18         |
| 2022/5/25 | -18         |
| 2022/5/26 | -18         |
| 2022/5/27 | -18         |
| 2022/5/31 | -18         |
| 2022/6/1  | -18         |
| 2022/6/2  | -18         |
| 2022/6/3  | -18         |
| 2022/6/6  | -18         |
| 2022/6/7  | -18         |
| 2022/6/8  | -16.5       |
| 2022/6/9  | -18         |
| 2022/6/10 | -18         |
| 2022/6/13 | -18         |
| 2022/6/14 | -16.5       |
| 2022/6/15 | -18         |
| 2022/6/16 | -18         |
| 2022/6/17 | -18         |
| 2022/6/21 | -16.5       |
| 2022/6/22 | -16.5       |
| 2022/6/23 | -18         |
| 2022/6/24 | -18         |
| 2022/6/27 | -20         |
| 2022/6/28 | -20         |
| 2022/6/29 | -20         |
| 2022/6/30 | -20         |
| 2022/7/1  | -20         |
| 2022/7/5  | -20.6       |

NVDA的数据基本符合预想，优秀的企业的利润确实很客观，下面来看看也算名气在外的企业：TESLA

##### 2.2 特斯拉 Tesla

我们直接展示部分的评分：

| date       | total_score  |
| ---------- | ------------ |
| 2019/8/6   | -9.4         |
| 2019/8/7   | -12.9        |
| 2019/8/8   | -12.9        |
| 2019/8/9   | -6.4         |
| 2019/8/12  | -20.4        |
| 2019/8/13  | -14.9        |
| 2019/8/14  | -22.4        |
| 2019/8/15  | -22.4        |
| 2019/8/16  | -18.9        |
| 2019/8/19  | -18.9        |
| 2019/8/20  | -15.9        |
| 2019/8/21  | -13.9        |
| 2019/8/22  | -16.9        |
| 2019/8/23  | -26.4        |
| 2019/8/26  | -13.9        |
| 2019/8/27  | -22.9        |
| 2019/8/28  | -15.9        |
| 2019/8/29  | -15.9        |
| 2019/8/30  | -22.4        |
| 2019/9/3   | -16.9        |
| 2019/9/4   | -22.4        |
| 2019/9/5   | -22.4        |
| 2019/9/6   | -13.9        |
| 2019/9/9   | -15.9        |
| 2019/9/10  | -12.9        |
| 2019/9/11  | -9.9         |
| 2019/9/12  | -13.4        |
| 2019/9/13  | -7.8         |
| 2019/9/16  | -10.8        |
| 2019/9/17  | -7.8         |
| 2019/9/18  | -5.8         |
| 2019/9/19  | -0.8         |
| 2019/9/20  | -14.3        |
| 2019/9/23  | -5.8         |
| 2019/9/24  | -21.8        |
| 2019/9/25  | -21.8        |
| 2019/9/26  | -9.3         |
| 2019/9/27  | -5.8         |
| 2019/9/30  | -10.8        |
| 2019/10/1  | -5.8         |
| 2019/10/2  | -0.8         |
| 2019/10/3  | -10.8        |
| 2019/10/4  | -16.3        |
| 2019/10/7  | -14.3        |
| 2019/10/8  | -9.3         |
| 2019/10/9  | -5.8         |
| 2019/10/10 | -3.8         |
| 2019/10/11 | -0.8         |
| 2019/10/14 | -4.3         |
| 2019/10/15 | 9.685386     |
| 2019/10/16 | 7.346337     |
| 2019/10/17 | 12.16898     |
| 2019/10/18 | 8.735365     |
| 2019/10/21 | -9.3         |
| 2019/10/22 | 12.44793     |
| 2019/10/23 | 14.48823     |
| 2019/10/24 | -5           |
| 2019/10/25 | -9.4         |
| 2019/10/28 | -5.9         |
| 2019/10/29 | -4.2         |
| 2019/10/30 | -2.2         |
| 2019/10/31 | 9.575937     |
| 2019/11/1  | 5.954944     |
| 2019/11/4  | -6.2         |
| 2019/11/5  | 7.312026     |
| 2019/11/6  | 0.452183     |
| 2019/11/7  | -4.9         |
| 2019/11/8  | 9.437353     |
| 2019/11/11 | 1.9          |
| 2019/11/12 | 6.269127     |
| 2019/11/13 | 3.08638      |
| 2019/11/14 | 6.848787     |
| 2019/11/15 | 13.79105     |
| 2019/11/18 | 12.2628      |
| 2019/11/19 | 3.94119      |
| 2019/11/20 | 5.040104     |
| 2019/11/21 | 12.21751     |
| 2019/11/22 | -0.4         |
| 2019/11/25 | -0.4         |
| 2019/11/26 | ==14.24181== |
| 2019/11/27 | ==20.42678== |
| 2019/11/29 | ==23.84604== |
| 2019/12/2  | ==16.31084== |
| 2019/12/3  | ==17.28941== |
| 2019/12/4  | ==18.34438== |
| 2019/12/5  | ==20.33395== |
| 2019/12/6  | ==17.79481== |

根据上一个的经验，对于15分以下的分数都有些抵抗力了，如果看得分的话我选在2019/11/26-2019/12/6进行购买，下面直接看图：

![l61yJ.png](https://s1.328888.xyz/2022/07/19/l61yJ.png)

90天100%-150%的回报率，且0止损情况。这样的收益率可遇不可求，需要更多的样本进行测试。

### 总结

虚拟货币的就不测试了，因为之前进行过很多测试，可以说这个系统就是为了交易虚拟货币提出的，当时进行了大量的回测。由于这次测试的样本很小，之后我的打算是进行一个小的对比，对比中美最强股的评分情况，一来是为了优化这个系统，二来是对比中美企业的区别。

通过这个测试整体下来我是比较满意的，但是距离实际的运行还有很长的路要走，中间有很多的问题还没有解决。希望自己能在接下来的时间进行修补和完善。

## 3. 可视化

个人认为比较方便也比较好看的是Pyechart，Plotly有些难用（应该是自己学艺不精，做出来的图不方便看也不方便拖拽），light-weight chart是tradingview的官方指定作图接口，但是对于JavaScript的能力要求比较高，有比较高的使用门槛但是上限非常的高。

制作可视化网页的原因是因为想制作一个完整交易系统，目前还有很多的问题没有解决，前端的JavaScript还不太熟悉，对于后端的倒是可以用flask凑合，但是想要实际使用最好还是用Nodejs，所以需要学习的东西还有不少。

### 3.1 Pyechart

demo：

pyechart_demo

### 3.2 Light-weight chart

还在熟悉的过程中……感觉pyechart已经达到自己的预期效果了，尽管上限比较低一些，对于目前的精力抽不出来时间再去改为Light-weight chart

## 4. 接下来的任务

由于之前的两个星期整个人都在埋头到整个项目里，没有及时地梳理头绪，比如做到了什么，接下来要做什么，从诞生想法到现在，已经过去了两周的时间，所以在这个节点上我认为有必要停下来，休息片刻，最重要的是整理出来一个完整的头绪，减少无用功。

### 已完成任务梳理

- [x] 单个股票的评分系统（初版）
- [x] 完整的数据获取工具其中包括：
  - [x] 中国股票列表（带分类）（tushare）
  - [x] 美国股票列表（带分类）（pyfinviz）
  - [x] 加密货币前200列表（coinmarketcap api）
  - [x] 中国单个股票价格（baostock）
  - [x] 美国单个股票价格（yfinance）

- [x] 完整的股票图（pyechart）其中包括了：
  - [x] open，close，high，low的K线图
  - [x] volume交易量
  - [x] MA10，MA20，MA50，MA150，MA200
- [x] 动态获取nasdaq100，sp500和dow jones50 (request beautifulsoap)
- [x] 动态获取上证50，沪深300和中证500 （baostock api）

### 之后的任务梳理

1. 优化评分系统
2. 搭建index评估系统（powerbi或其它）
3. 搭建长期交易系统（动态止损）
4. 搭建回测系统
5. 搭建日内交易系统
6. 图像上自动添加buy-zone
7. 图像上的添加标签功能（选）

除了图片上的小功能外都是比较大的功能了，这个文档的梳理也到此结束，剩下的几个系统我都从开始想法从头开始，阐释自己的思想和实现过程中的所有问题。

